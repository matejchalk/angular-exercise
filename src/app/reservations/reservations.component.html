<main>
  <div id="heading">
    <div id="main-heading">
      <div id="type">
        <app-dropdown [options]="['Past Reservations']"></app-dropdown>
      </div>
      <div id="total">{{ reservations.length }} Total</div>
      <div id="sort-by">
        <label>Sort by:</label>
        <app-dropdown [(value)]="sortKey" [options]="sortKeys" (valueChange)="onSortKeyChange()"></app-dropdown>
      </div>
    </div>
    <button id="filter" [class.enabled]="filterEnabled" (click)="toggleFilterEnabled()">Filter</button>
  </div>
  <section>
    <header>
      <div class="add">
        <app-dropdown [options]="actions" (valueChange)="performAction($event)" [hideIcon]="true">
          <div>+</div>
        </app-dropdown>
      </div>
      <div>LISTING NAME</div>
      <div>TRIP DATE</div>
      <div>NIGHTS</div>
      <div>GUEST</div>
      <div>TRAVELLERS</div>
      <div>PRICE</div>
      <div>STATUS</div>
      <div class="page-switcher">
        <button class="left" [disabled]="!previousPageAvailable()" (click)="previousPage()"></button>
        <button class="right" [disabled]="!nextPageAvailable()" (click)="nextPage()"></button>
      </div>
    </header>
    <div *ngFor="let reservation of pages[currentPage]">
      <div class="select">
        <app-checkbox></app-checkbox>
      </div>
      <div class="listing-name">
        <img alt="[IMG]" src="https://cdn3.i-scmp.com/sites/default/files/images/methode/2017/08/16/243f89e0-8235-11e7-a767-bc310e55dd10_1320x770_154749.jpg" />
        <div>
          <div class="name">{{ reservation.listingName.name }}</div>
          <div class="location">{{ reservation.listingName.location }}</div>
        </div>
      </div>
      <div class="trip-date">
        <div>
          {{ reservation.tripDate.checkInDate | date:(spansYears(reservation) ? 'd MMM y' : (spansMonths(reservation) ? 'd MMM' : 'd')) }}
        </div>
        <div>&nbsp;-&nbsp;</div>
        <div>
          {{ reservation.tripDate.checkOutDate | date:'d MMM y' }}
        </div>
      </div>
      <div>{{ reservation.nights }} Nights</div>
      <div>{{ reservation.guests }} Guest</div>
      <div class="travellers">
        <img alt="[IMG]" src="{{ reservation.travellers[0].avatar || 'https://allinonetricks.com/wp-content/uploads/2017/08/5-7.png' }}" />
        <div>{{ reservation.travellers[0].name }}</div>
      </div>
      <div>{{ currency }} {{ getConvertedPrice(reservation) | number }}</div>
      <div class="status-{{ reservation.status | lowercase }}">
        <span>{{ reservation.status }}</span>
      </div>
      <div class="extra">
        <app-dropdown [options]="actions" (valueChange)="performAction($event, reservation)" [hideIcon]="true" [requireClick]="true">
          <button></button>
        </app-dropdown>
      </div>
    </div>
  </section>
</main>

<app-filters (filtersChange)="updateFilters($event)"></app-filters>
